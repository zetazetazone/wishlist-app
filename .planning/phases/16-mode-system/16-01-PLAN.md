---
phase: 16-mode-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/groups/GroupCard.tsx
  - components/groups/MemberCard.tsx
  - app/group/[id]/index.tsx
autonomous: true

must_haves:
  truths:
    - "GroupCard on home screen shows mode indicator badge (Greetings or Gifts)"
    - "MemberCard hides favorite preview area when group is in Greetings mode"
    - "Group view screen passes mode to MemberCard for conditional rendering"
  artifacts:
    - path: "components/groups/GroupCard.tsx"
      provides: "GroupModeBadge integrated into group card on home screen"
      contains: "GroupModeBadge"
    - path: "components/groups/MemberCard.tsx"
      provides: "Mode-conditional favorite preview hiding"
      contains: "mode"
    - path: "app/group/[id]/index.tsx"
      provides: "Mode prop passed through to MemberCard"
      contains: "mode"
  key_links:
    - from: "components/groups/GroupCard.tsx"
      to: "components/groups/GroupModeBadge.tsx"
      via: "import and render"
      pattern: "GroupModeBadge"
    - from: "app/group/[id]/index.tsx"
      to: "components/groups/MemberCard.tsx"
      via: "mode prop"
      pattern: "mode.*greetings"
---

<objective>
Add mode indicator badge to group cards on the home screen and implement mode-conditional rendering in the group view (hide favorite previews on MemberCards in Greetings mode).

Purpose: MODE-01 (mode badge on group cards) and MODE-02 (greetings mode hides gift-related UI on group view screen).
Output: GroupCard shows GroupModeBadge, MemberCard conditionally hides favorite preview in Greetings mode.
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-mode-system/16-CONTEXT.md

@components/groups/GroupCard.tsx
@components/groups/GroupModeBadge.tsx
@components/groups/MemberCard.tsx
@components/groups/FavoritePreview.tsx
@app/group/[id]/index.tsx
@types/database.types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add GroupModeBadge to GroupCard on home screen</name>
  <files>components/groups/GroupCard.tsx</files>
  <action>
    Import GroupModeBadge from ./GroupModeBadge. Replace the existing inline mode indicator in GroupCard (the hand-wave/cash icon with "Greetings only" / "$X per gift" text around lines 52-69) with the GroupModeBadge component. Place it below the group name, where the current mode text is. The GroupModeBadge already handles both mode styles (burgundy for Gifts, gold for Greetings) so it replaces the manual icon/text.

    The Group type from database.types.ts already includes `mode: 'greetings' | 'gifts'` so no type changes needed.

    Keep the member count badge on the right side. The layout should be:
    - Top row: Group name (left) + member count badge (right)
    - Below name: GroupModeBadge component (compact, inline)

    Remove the old budget_limit_per_gift display since that belongs to Phase 17 (budget tracking). Just show the mode badge.
  </action>
  <verify>
    TypeScript compiles without errors: `npx tsc --noEmit --pretty 2>&1 | head -30`
    GroupCard renders GroupModeBadge component (check import exists).
  </verify>
  <done>GroupCard on home screen displays GroupModeBadge for both Greetings and Gifts modes, replacing the old inline mode text.</done>
</task>

<task type="auto">
  <name>Task 2: Add mode-conditional favorite hiding to MemberCard and group view</name>
  <files>components/groups/MemberCard.tsx, app/group/[id]/index.tsx</files>
  <action>
    **MemberCard changes:**
    Add an optional `mode` prop to MemberCardProps: `mode?: 'greetings' | 'gifts'`. When mode is 'greetings', hide the favorite preview section entirely (hard hide, not disabled -- this is cleaner and avoids showing gift-related UI that would confuse users in a greetings-only group). The favorite preview area (lines 185-189) should only render when mode is NOT 'greetings' (i.e., when mode is undefined or 'gifts').

    Decision (Claude's discretion per CONTEXT.md): Use hard hide (do not render) rather than disabled state. Greetings mode should feel clean -- no grayed-out gift references. When favorite preview is hidden, no replacement content needed -- the card simply becomes more compact with just name + birthday countdown.

    **Group view (app/group/[id]/index.tsx) changes:**
    Pass `group.mode` (or fallback 'gifts') through to each MemberCard as the `mode` prop. The group object from fetchGroupDetails already includes the mode field from the database.

    In the MemberCard rendering loop (~line 253), add: `mode={group.mode || 'gifts'}` to the MemberCard props.
  </action>
  <verify>
    TypeScript compiles without errors: `npx tsc --noEmit --pretty 2>&1 | head -30`
    MemberCard accepts mode prop. Group view passes mode to MemberCard.
  </verify>
  <done>MemberCards in Greetings mode groups show only name and birthday countdown (no favorite preview). Gifts mode groups show favorite preview as before.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes (or shows only pre-existing errors)
2. GroupCard.tsx imports and renders GroupModeBadge
3. MemberCard.tsx accepts mode prop and conditionally renders favorite preview
4. app/group/[id]/index.tsx passes mode prop to MemberCard
</verification>

<success_criteria>
- GroupModeBadge visible on group cards in the home screen groups list (MODE-01 for group cards)
- Greetings mode groups show MemberCards without favorite preview section (MODE-02 partial)
- Gifts mode groups show MemberCards with favorite preview as before (no regression)
- No new TypeScript errors introduced
</success_criteria>

<output>
After completion, create `.planning/phases/16-mode-system/16-01-SUMMARY.md`
</output>
