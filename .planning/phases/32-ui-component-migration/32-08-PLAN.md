---
phase: 32-ui-component-migration
plan: 08
type: execute
wave: 3
depends_on: ["32-02"]
files_modified:
  - components/wishlist/ClaimButton.tsx
  - components/wishlist/ClaimerAvatar.tsx
  - components/wishlist/TakenBadge.tsx
  - components/wishlist/TakenCounter.tsx
  - components/wishlist/YourClaimIndicator.tsx
  - components/wishlist/ClaimTimestamp.tsx
  - components/wishlist/SplitContributionProgress.tsx
  - components/wishlist/ContributorsDisplay.tsx
  - components/wishlist/SplitModal.tsx
  - components/wishlist/OpenSplitModal.tsx
autonomous: true

must_haves:
  truths:
    - "Claim buttons display in selected language"
    - "Taken badges display in selected language"
    - "Split contribution UI displays in selected language"
    - "Claim timestamps display in localized format"
  artifacts:
    - path: "components/wishlist/ClaimButton.tsx"
      provides: "Translated claim button"
      contains: "useTranslation"
    - path: "components/wishlist/TakenBadge.tsx"
      provides: "Translated taken badge"
      contains: "useTranslation"
    - path: "components/wishlist/ClaimTimestamp.tsx"
      provides: "Localized claim timestamp"
      contains: "useLocalizedFormat"
  key_links:
    - from: "components/wishlist/ClaimTimestamp.tsx"
      to: "hooks/useLocalizedFormat.ts"
      via: "formatDistanceToNow"
      pattern: "useLocalizedFormat"
---

<objective>
Migrate claim and split contribution components (10 files) to use translations

Purpose: Claim and split features are key gift coordination functionality
Output: All claim/split components display in selected language with localized timestamps
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/32-ui-component-migration/32-RESEARCH.md
@src/i18n/locales/en.json
@hooks/useLocalizedFormat.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate claim components</name>
  <files>
    components/wishlist/ClaimButton.tsx
    components/wishlist/ClaimerAvatar.tsx
    components/wishlist/TakenBadge.tsx
    components/wishlist/TakenCounter.tsx
    components/wishlist/YourClaimIndicator.tsx
    components/wishlist/ClaimTimestamp.tsx
  </files>
  <action>
1. For ClaimButton.tsx:
   - Add `import { useTranslation } from 'react-i18next';`
   - Add `const { t } = useTranslation();`
   - Translate:
     - "Claim" button text: `t('wishlist.claim.claim')`
     - "Unclaim" button text: `t('wishlist.claim.unclaim')`
     - Any accessibility labels

2. For ClaimerAvatar.tsx:
   - Add imports and hook
   - Translate "Claimed by {{name}}": `t('wishlist.claim.claimedBy', { name: claimerName })`
   - Accessibility labels if present

3. For TakenBadge.tsx:
   - Add imports and hook
   - Translate "Taken" text: `t('wishlist.claim.taken')`

4. For TakenCounter.tsx:
   - Add imports and hook
   - Translate counter text (e.g., "3 of 8 items claimed")
   - May need to add translation key if not exists, or construct with:
     ```typescript
     t('wishlist.claim.itemsClaimed', { claimed: claimedCount, total: totalCount })
     ```

5. For YourClaimIndicator.tsx:
   - Add imports and hook
   - Translate "You claimed this": `t('wishlist.claim.youClaimed')`

6. For ClaimTimestamp.tsx:
   - Add imports:
     ```typescript
     import { useTranslation } from 'react-i18next';
     import { useLocalizedFormat } from '@/hooks/useLocalizedFormat';
     ```
   - Add hooks: `const { t } = useTranslation();` and `const { formatDistanceToNow, format } = useLocalizedFormat();`
   - Replace date-fns direct calls with localized versions:
     ```typescript
     // Before
     formatDistanceToNow(date, { addSuffix: true })
     // After (using hook)
     formatDistanceToNow(date, { addSuffix: true })  // Hook returns localized version
     ```
   - Any static text like "Claimed" prefix should use t()
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `grep -l "useTranslation" components/wishlist/ClaimButton.tsx`
    - `grep -l "useTranslation" components/wishlist/TakenBadge.tsx`
    - `grep -l "useLocalizedFormat" components/wishlist/ClaimTimestamp.tsx`
  </verify>
  <done>
    - All 6 claim components use translations
    - ClaimTimestamp uses useLocalizedFormat for localized timestamps
    - "Taken", "Claim", "Unclaim" display in selected language
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate split contribution components</name>
  <files>
    components/wishlist/SplitContributionProgress.tsx
    components/wishlist/ContributorsDisplay.tsx
    components/wishlist/SplitModal.tsx
    components/wishlist/OpenSplitModal.tsx
  </files>
  <action>
1. For SplitContributionProgress.tsx:
   - Add imports and hook
   - Translate:
     - "Funded" label: `t('wishlist.split.funded')`
     - "Fully Funded" status: `t('wishlist.split.fullyFunded')`
     - Percentage/amount formatting (may use Intl.NumberFormat)

2. For ContributorsDisplay.tsx:
   - Add imports and hook
   - Translate:
     - "Contributors" header: `t('wishlist.split.contributors')`
     - Contribution amounts (format with locale)

3. For SplitModal.tsx:
   - Add imports and hook
   - Translate:
     - "Split Payment" title: `t('wishlist.split.title')`
     - "Your Contribution" label: `t('wishlist.split.yourContribution')`
     - "Enter amount" placeholder: `t('wishlist.split.enterAmount')`
     - "Contribute" button: `t('wishlist.split.contribute')`
     - Validation messages
   - All Alert.alert() calls

4. For OpenSplitModal.tsx:
   - Add imports and hook
   - Translate:
     - "Open Split" title/button: `t('wishlist.split.openSplit')`
     - "Close Split" option: `t('wishlist.split.closeSplit')`
     - Description/instructions
   - All Alert.alert() calls:
     ```typescript
     Alert.alert(
       t('alerts.titles.error'),
       t('alerts.messages.failedOpenSplit')
     );
     ```
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `grep -l "useTranslation" components/wishlist/SplitContributionProgress.tsx`
    - `grep -l "useTranslation" components/wishlist/SplitModal.tsx`
    - `grep -l "useTranslation" components/wishlist/OpenSplitModal.tsx`
  </verify>
  <done>
    - All 4 split components use translations
    - Split modal forms display in selected language
    - Progress and contributor displays translated
    - All Alert.alert() calls translated
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles: `npx tsc --noEmit`
2. All 10 claim/split components use useTranslation
3. ClaimTimestamp uses useLocalizedFormat
4. Run app, switch to Spanish, verify claim/split UI shows Spanish
</verification>

<success_criteria>
- All claim components display in selected language
- Claim timestamps display in localized format (e.g., "hace 2 horas")
- Split contribution UI displays in selected language
- TakenBadge shows "Tomado" in Spanish
- No hardcoded English strings remain in claim/split components
</success_criteria>

<output>
After completion, create `.planning/phases/32-ui-component-migration/32-08-SUMMARY.md`
</output>
