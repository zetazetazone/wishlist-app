---
phase: 32-ui-component-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - hooks/useLocalizedFormat.ts
  - .eslintrc.js
autonomous: true

must_haves:
  truths:
    - "Date formatting functions receive correct locale based on current language"
    - "Switching language updates date format output (English vs Spanish)"
    - "ESLint rule detects hardcoded JSX strings"
  artifacts:
    - path: "hooks/useLocalizedFormat.ts"
      provides: "Localized date formatting hook"
      exports: ["useLocalizedFormat"]
    - path: ".eslintrc.js"
      provides: "i18next linting rule configuration"
      contains: "i18next/no-literal-string"
  key_links:
    - from: "hooks/useLocalizedFormat.ts"
      to: "react-i18next"
      via: "useTranslation i18n.language"
      pattern: "i18n\\.language"
    - from: "hooks/useLocalizedFormat.ts"
      to: "date-fns/locale"
      via: "locale import"
      pattern: "from 'date-fns/locale'"
---

<objective>
Create the useLocalizedFormat hook and ESLint verification tooling as foundation for UI migration

Purpose: Provides localized date formatting for 12+ files using date-fns, and enables automated detection of remaining hardcoded strings
Output: hooks/useLocalizedFormat.ts, updated .eslintrc.js with i18next plugin
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/32-ui-component-migration/32-RESEARCH.md
@src/i18n/locales/en.json
@hooks/useLanguage.ts
@lib/language.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create useLocalizedFormat hook</name>
  <files>hooks/useLocalizedFormat.ts</files>
  <action>
Create a new hook that wraps date-fns formatting functions with automatic locale selection:

1. Import dependencies:
   - `useCallback`, `useMemo` from 'react'
   - `useTranslation` from 'react-i18next'
   - `format`, `formatDistanceToNow`, `formatRelative` from 'date-fns'
   - `enUS`, `es` from 'date-fns/locale'
   - `SupportedLanguage` from '@/lib/language'

2. Create locale map:
   ```typescript
   const localeMap: Record<SupportedLanguage, Locale> = {
     en: enUS,
     es: es,
   };
   ```

3. Implement hook that:
   - Gets current language from `useTranslation().i18n.language`
   - Returns memoized locale object based on language
   - Returns memoized `format` function wrapping date-fns format with locale
   - Returns memoized `formatDistanceToNow` function with locale
   - Returns memoized `formatRelative` function with locale
   - Returns raw `locale` for components needing direct access

4. Export signature:
   ```typescript
   export function useLocalizedFormat(): {
     format: (date: Date | number, formatStr: string) => string;
     formatDistanceToNow: (date: Date | number, options?: { addSuffix?: boolean }) => string;
     formatRelative: (date: Date | number, baseDate: Date) => string;
     locale: Locale;
   }
   ```

Follow the pattern from 32-RESEARCH.md Code Examples section.
  </action>
  <verify>
    - `npx tsc --noEmit` passes (no TypeScript errors)
    - File exports useLocalizedFormat function
  </verify>
  <done>
    - useLocalizedFormat hook exists and exports format, formatDistanceToNow, formatRelative, locale
    - TypeScript compilation succeeds
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure eslint-plugin-i18next</name>
  <files>.eslintrc.js</files>
  <action>
1. Install the ESLint plugin:
   ```bash
   npm install --save-dev eslint-plugin-i18next
   ```

2. Update .eslintrc.js to add i18next plugin and rule:
   - Add 'i18next' to plugins array
   - Add 'i18next/no-literal-string' rule with configuration:
     ```javascript
     'i18next/no-literal-string': [
       'warn',
       {
         markupOnly: true,
         ignoreAttribute: [
           'testID',
           'name',
           'style',
           'source',
           'key',
           'type',
           'accessibilityRole',
           'href',
           'resizeMode',
           'contentFit',
           'behavior',
         ],
         ignoreComponent: ['Trans'],
       },
     ],
     ```

3. The rule should be 'warn' not 'error' to allow incremental migration without blocking builds.
  </action>
  <verify>
    - `npm run lint -- --rule 'i18next/no-literal-string: warn' app/(app)/settings/profile.tsx 2>&1 | head -20` shows warnings for hardcoded strings (or no errors if already migrated)
    - Package.json shows eslint-plugin-i18next in devDependencies
  </verify>
  <done>
    - eslint-plugin-i18next installed as devDependency
    - ESLint config updated with i18next plugin and no-literal-string rule at warn level
    - Running ESLint on unmigrated files produces warnings for hardcoded strings
  </done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors: `npx tsc --noEmit`
2. useLocalizedFormat hook can be imported: `grep -l "useLocalizedFormat" hooks/`
3. ESLint plugin installed: `grep "eslint-plugin-i18next" package.json`
4. ESLint rule configured: `grep "no-literal-string" .eslintrc.js`
</verification>

<success_criteria>
- useLocalizedFormat hook exists at hooks/useLocalizedFormat.ts
- Hook exports format, formatDistanceToNow, formatRelative functions with locale
- eslint-plugin-i18next installed and configured
- Running eslint shows warnings for hardcoded strings in unmigrated files
</success_criteria>

<output>
After completion, create `.planning/phases/32-ui-component-migration/32-01-SUMMARY.md`
</output>
