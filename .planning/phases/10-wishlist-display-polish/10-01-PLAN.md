---
phase: 10-wishlist-display-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/(app)/(tabs)/wishlist.tsx
  - components/ui/StarRating.tsx
autonomous: true

must_haves:
  truths:
    - "User sees their profile picture in the My Wishlist header"
    - "Tapping profile picture navigates to profile settings"
    - "User sees horizontal star ratings on wishlist item cards"
    - "Profile picture updates when changed in settings"
  artifacts:
    - path: "app/(app)/(tabs)/wishlist.tsx"
      provides: "Profile header with avatar and tap-to-navigate"
      contains: "useRouter.*settings/profile"
    - path: "components/ui/StarRating.tsx"
      provides: "Horizontal star rating display"
      contains: "flexDirection.*row"
  key_links:
    - from: "app/(app)/(tabs)/wishlist.tsx"
      to: "settings/profile"
      via: "router.push on avatar tap"
      pattern: "router\\.push.*settings/profile"
    - from: "app/(app)/(tabs)/wishlist.tsx"
      to: "lib/storage.ts"
      via: "getAvatarUrl import and usage"
      pattern: "getAvatarUrl"
---

<objective>
Add profile picture display to My Wishlist header with tap-to-navigate, and ensure star ratings display horizontally.

Purpose: Complete WISH-01 and WISH-02 requirements to polish the My Wishlist screen with profile picture in header and horizontal star ratings.

Output: Enhanced My Wishlist screen with user avatar in header and properly styled star ratings.
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-wishlist-display-polish/10-CONTEXT.md

# Existing implementations for reference
@app/(app)/(tabs)/wishlist.tsx
@app/(app)/settings/profile.tsx
@components/ui/StarRating.tsx
@lib/storage.ts
@constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add profile header with avatar to My Wishlist</name>
  <files>app/(app)/(tabs)/wishlist.tsx</files>
  <action>
Add profile picture with greeting to the My Wishlist header. Implement:

1. Import requirements:
   - Add `useRouter` from 'expo-router'
   - Add `getAvatarUrl` from '../../../lib/storage'
   - Add `Image` from 'react-native'

2. Add state for user profile:
   - `userProfile` state with `{ display_name: string | null; avatar_url: string | null }`
   - Load profile in `getCurrentUser` function alongside existing user fetch
   - Query `user_profiles` table for `display_name` and `avatar_url`

3. Update header layout inside the LinearGradient header:
   - Add a row above "My Wishlist" title with profile picture + greeting
   - Profile picture: 64px circular avatar (borderRadius: 32)
   - Use `getAvatarUrl(userProfile?.avatar_url)` for image source
   - Fallback: Show initials circle (first letter of display_name or "?") with gold[200] background
   - Add white 2px border around avatar for visual pop
   - Greeting text: "Hi, {firstName}!" in gold[200] color, fontSize 16

4. Tap interaction:
   - Wrap avatar in TouchableOpacity
   - On tap: `router.push('/settings/profile')`
   - Add subtle scale animation on press (activeOpacity: 0.8)

5. Layout positioning per CONTEXT.md decisions:
   - Profile row above title row
   - Left-aligned profile picture
   - Greeting text to the right of avatar with spacing.sm gap
   - Maintain existing title + count + FAB button layout below

Header structure should be:
```
[Avatar][Greeting "Hi, Name!"]
[Title "My Wishlist"]  [+ FAB]
[Count "N gifts"]
```
  </action>
  <verify>
Run expo and verify:
1. Avatar appears in header (or initials fallback)
2. Greeting shows user's first name
3. Tapping avatar navigates to settings/profile
4. After changing photo in settings and returning, avatar updates
  </verify>
  <done>Profile picture displays in My Wishlist header with tap-to-navigate functionality</done>
</task>

<task type="auto">
  <name>Task 2: Ensure star ratings display horizontally</name>
  <files>components/ui/StarRating.tsx</files>
  <action>
Verify and ensure StarRating component renders horizontally with gold accent styling per CONTEXT.md:

1. Update layout to use inline styles (not NativeWind classes for consistency):
   - Replace `className="flex-row items-center gap-1"` with inline style
   - Use `flexDirection: 'row'`, `alignItems: 'center'`, `gap: 4`

2. Update star appearance per CONTEXT.md gold accent requirement:
   - Import `colors` from '../../constants/theme'
   - Filled star: Use gold color (colors.gold[500])
   - Empty star: Use light gold/cream (colors.gold[200])
   - Replace emoji stars with MaterialCommunityIcons for better styling:
     - 'star' (filled) vs 'star-outline' (empty)
     - Apply appropriate color based on filled state

3. Ensure proper sizing for card context:
   - Default size should work well in card context (size prop already exists)
   - Icons should be appropriately scaled

The component should render as a clean horizontal row of gold stars matching the app's luxury aesthetic.
  </action>
  <verify>
Run expo and verify:
1. Stars display in a horizontal row (not vertical)
2. Stars use gold accent color matching app theme
3. Priority is visually clear (filled vs unfilled)
4. Star size appropriate within wishlist cards
  </verify>
  <done>Star ratings display horizontally with gold accent styling consistent with app theme</done>
</task>

</tasks>

<verification>
After both tasks complete, verify end-to-end:

1. **WISH-02 - Profile Picture:**
   - My Wishlist screen shows profile avatar in header
   - Avatar is circular, appropriately sized (64px)
   - Tapping avatar navigates to profile settings
   - Initials fallback works when no photo uploaded
   - Avatar updates immediately after changing in settings

2. **WISH-01 - Star Ratings:**
   - Star ratings display horizontally within cards
   - Gold color scheme matches favorites/mystery box aesthetic
   - 5-star scale clearly shows item priority
   - Stars sized appropriately for card context

3. **Visual consistency:**
   - Header layout balanced and not cluttered
   - Greeting text readable against gradient
   - Overall polish enhances the luxury boutique feel
</verification>

<success_criteria>
- Profile picture visible in My Wishlist header
- Tapping profile navigates to settings/profile
- Star ratings display horizontally (not vertically)
- Gold accent color used for star ratings
- No regression in existing wishlist functionality
- WISH-01 and WISH-02 requirements satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/10-wishlist-display-polish/10-01-SUMMARY.md`
</output>
