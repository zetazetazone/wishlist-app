---
phase: 08-special-item-types
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - components/wishlist/ItemTypeBadge.tsx
  - components/wishlist/LuxuryWishlistCard.tsx
autonomous: true

must_haves:
  truths:
    - "Surprise Me items display with distinct burgundy badge and help-circle icon"
    - "Mystery Box items display with distinct gold badge showing tier amount"
    - "Standard items show no badge (existing appearance)"
    - "View on Amazon button hidden for special items"
    - "Special items appear correctly in owner's wishlist view"
  artifacts:
    - path: "components/wishlist/ItemTypeBadge.tsx"
      provides: "Reusable badge component for item types"
      exports: ["ItemTypeBadge"]
    - path: "components/wishlist/LuxuryWishlistCard.tsx"
      provides: "Type-aware card rendering"
      contains: "item_type !== 'standard'"
  key_links:
    - from: "components/wishlist/LuxuryWishlistCard.tsx"
      to: "components/wishlist/ItemTypeBadge.tsx"
      via: "import and render"
      pattern: "ItemTypeBadge.*item.item_type"
---

<objective>
Add visual distinction for special item types in wishlist card display.

Purpose: Users can visually identify Surprise Me and Mystery Box items at a glance through distinct badges, icons, and styling - requirement SPEC-05.

Output: New ItemTypeBadge component, updated LuxuryWishlistCard with type-aware rendering.
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-special-item-types/08-RESEARCH.md
@types/database.types.ts
@components/wishlist/LuxuryWishlistCard.tsx
@constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ItemTypeBadge component</name>
  <files>components/wishlist/ItemTypeBadge.tsx</files>
  <action>
Create a new ItemTypeBadge.tsx component in components/wishlist/:

```typescript
import { View, Text } from 'react-native';
import { MaterialCommunityIcons } from '@expo/vector-icons';
import { colors, spacing, borderRadius } from '../../constants/theme';

interface ItemTypeBadgeProps {
  itemType: 'standard' | 'surprise_me' | 'mystery_box';
  tier?: 25 | 50 | 100 | null;
}

export function ItemTypeBadge({ itemType, tier }: ItemTypeBadgeProps) {
  // Standard items show no badge
  if (itemType === 'standard') return null;

  const config = {
    surprise_me: {
      icon: 'help-circle' as const,
      text: 'Surprise Me',
      bgColor: colors.burgundy[100],
      textColor: colors.burgundy[700],
      iconColor: colors.burgundy[600],
    },
    mystery_box: {
      icon: 'gift' as const,
      text: tier ? `€${tier} Mystery Box` : 'Mystery Box',
      bgColor: colors.gold[100],
      textColor: colors.gold[700],
      iconColor: colors.gold[600],
    },
  }[itemType];

  return (
    <View
      style={{
        flexDirection: 'row',
        alignItems: 'center',
        backgroundColor: config.bgColor,
        paddingHorizontal: spacing.sm,
        paddingVertical: spacing.xs,
        borderRadius: borderRadius.sm,
        alignSelf: 'flex-start',
        marginBottom: spacing.xs,
      }}
    >
      <MaterialCommunityIcons
        name={config.icon}
        size={14}
        color={config.iconColor}
        style={{ marginRight: spacing.xs }}
      />
      <Text
        style={{
          fontSize: 12,
          fontWeight: '600',
          color: config.textColor,
        }}
      >
        {config.text}
      </Text>
    </View>
  );
}

export default ItemTypeBadge;
```

Key styling decisions:
- Surprise Me: burgundy tones (matches app's primary color, signals "personal/open")
- Mystery Box: gold tones (matches luxury theme, signals "premium/special")
- Compact size (fontSize: 12, small padding) to not overwhelm card
- Self-aligning to flex-start so it doesn't stretch
- Euro symbol for tier display (per requirements)
  </action>
  <verify>
File exists: `ls components/wishlist/ItemTypeBadge.tsx`
TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
ItemTypeBadge component created with distinct styling for Surprise Me (burgundy) and Mystery Box (gold with tier).
  </done>
</task>

<task type="auto">
  <name>Task 2: Update LuxuryWishlistCard for type-aware rendering</name>
  <files>components/wishlist/LuxuryWishlistCard.tsx</files>
  <action>
Update LuxuryWishlistCard.tsx to handle special item types:

1. Import ItemTypeBadge:
   ```typescript
   import { ItemTypeBadge } from './ItemTypeBadge';
   ```

2. Add helper to detect special items:
   ```typescript
   const isSpecialItem = item.item_type && item.item_type !== 'standard';
   ```

3. Update the icon based on item type (replace static "gift" icon):
   ```typescript
   const getCardIcon = () => {
     switch (item.item_type) {
       case 'surprise_me':
         return 'help-circle';
       case 'mystery_box':
         return 'gift';
       default:
         return 'gift-outline';
     }
   };
   ```
   Then use: `<MaterialCommunityIcons name={getCardIcon()} ...`

4. Add ItemTypeBadge to card header (after the icon box, before title):
   ```typescript
   {isSpecialItem && (
     <ItemTypeBadge
       itemType={item.item_type}
       tier={item.mystery_box_tier}
     />
   )}
   ```

5. Update price display to handle special items:
   ```typescript
   const formatPrice = (price?: number | null) => {
     if (item.item_type === 'mystery_box' && item.mystery_box_tier) {
       return `€${item.mystery_box_tier}`;
     }
     if (item.item_type === 'surprise_me' && item.surprise_me_budget) {
       return `Budget: €${item.surprise_me_budget}`;
     }
     if (!price) return null;
     return `$${price.toFixed(2)}`;
   };
   ```

6. Conditionally hide "View on Amazon" button for special items:
   ```typescript
   {!isSpecialItem && (
     <TouchableOpacity onPress={handleOpenLink} ...>
       {/* View on Amazon button */}
     </TouchableOpacity>
   )}
   ```

7. Guard handleOpenLink to prevent opening empty URLs:
   ```typescript
   const handleOpenLink = async () => {
     if (isSpecialItem || !item.amazon_url) return;
     // ... existing logic
   };
   ```

8. Optional: Update card border color for special items:
   ```typescript
   const getCardBorderColor = () => {
     switch (item.item_type) {
       case 'surprise_me':
         return colors.burgundy[200];
       case 'mystery_box':
         return colors.gold[300];
       default:
         return colors.gold[100];
     }
   };
   ```
   Then use in card style: `borderColor: getCardBorderColor()`

9. Update LinearGradient colors for special items (optional visual flair):
   ```typescript
   const getGradientColors = (): [string, string] => {
     switch (item.item_type) {
       case 'surprise_me':
         return [colors.burgundy[400], colors.burgundy[600]];
       case 'mystery_box':
         return [colors.gold[400], colors.gold[600]];
       default:
         return [colors.gold[400], colors.gold[600]];
     }
   };
   ```
   Then use: `<LinearGradient colors={getGradientColors()} ...`
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit`
Test in app: Add Surprise Me item, verify it shows burgundy badge with "Surprise Me" text.
Test in app: Add Mystery Box (50), verify it shows gold badge with "50 Mystery Box".
Test in app: Standard items show no badge and "View on Amazon" button.
  </verify>
  <done>
LuxuryWishlistCard displays type-appropriate badges, icons, and hides Amazon button for special items.
  </done>
</task>

</tasks>

<verification>
1. Run `npx tsc --noEmit` - no TypeScript errors
2. Open app, navigate to My Wishlist
3. Add a Surprise Me item (from 08-01 work)
4. Verify Surprise Me card shows:
   - Burgundy "Surprise Me" badge with help-circle icon
   - help-circle icon in card header
   - No "View on Amazon" button
   - Budget displayed if provided
5. Add a Mystery Box (50) item
6. Verify Mystery Box card shows:
   - Gold "50 Mystery Box" badge
   - gift icon in card header
   - No "View on Amazon" button
   - 50 in price area
7. Add a standard gift item
8. Verify standard card shows:
   - No badge
   - gift-outline icon
   - "View on Amazon" button works
   - Normal price display
</verification>

<success_criteria>
- ItemTypeBadge component exists and exports correctly
- Surprise Me items have distinct burgundy styling
- Mystery Box items have distinct gold styling with tier
- Standard items unchanged (no badge, Amazon button visible)
- "View on Amazon" hidden for special items
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-special-item-types/08-02-SUMMARY.md`
</output>
