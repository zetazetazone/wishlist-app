---
phase: 19-gift-claims-ui
plan: 05
type: execute
wave: 4
depends_on: ["19-03", "19-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Member can tap Claim button and item becomes claimed"
    - "Celebrant sees taken status without claimer name"
    - "Group members see who claimed which items"
    - "Member can unclaim their own claimed items"
    - "Surprise Me and Mystery Box items have no claim button"
---

<objective>
Visual verification checkpoint for the Gift Claims UI implementation. Verify all claim scenarios work correctly across both views (celebration page and My Wishlist).

Purpose: Ensure claim functionality works end-to-end before marking phase complete.
Output: User approval of all claim UI behaviors.
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/19-gift-claims-ui/19-CONTEXT.md
@.planning/phases/19-gift-claims-ui/19-03-SUMMARY.md
@.planning/phases/19-gift-claims-ui/19-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Gift Claims UI implementation:
1. Claim UI components (ClaimButton, ClaimerAvatar, TakenBadge, YourClaimIndicator, TakenCounter)
2. LuxuryWishlistCard extended with claim props
3. Celebration page claim integration (non-celebrant view)
4. My Wishlist taken integration (celebrant view)
  </what-built>
  <how-to-verify>
**Test Setup:**
You need two users in the same group where one has a birthday celebration.
- User A: The celebrant (birthday person)
- User B: Another group member

**Test 1: Non-Celebrant Claim Flow (User B)**
1. Login as User B (not the celebrant)
2. Navigate to User A's celebration page
3. In the wishlist section:
   - [ ] Standard items show a "Claim" button
   - [ ] Surprise Me items do NOT show a Claim button
   - [ ] Mystery Box items do NOT show a Claim button
4. Tap "Claim" on a standard item:
   - [ ] Confirmation dialog appears ("Claim this item?")
   - [ ] After confirming, loading spinner shows briefly
   - [ ] Item now shows "Your claim" indicator
   - [ ] Claim button becomes "Unclaim" button
5. Claimed item sorting:
   - [ ] Your claimed item moves toward bottom of list

**Test 2: Viewing Claims by Others (User B)**
1. Have another user (or in another session) claim a different item
2. As User B, refresh the celebration page:
   - [ ] Claimed items show small claimer avatar
   - [ ] Tapping avatar shows popup with claimer's name
   - [ ] You can still see who claimed what

**Test 3: Unclaim Flow (User B)**
1. As User B, find an item you claimed
2. Tap "Unclaim":
   - [ ] Confirmation dialog appears
   - [ ] After confirming, claim is released
   - [ ] Item shows "Claim" button again

**Test 4: Celebrant Taken View (User A)**
1. Login as User A (the celebrant)
2. Navigate to My Wishlist screen:
   - [ ] Claimed items show gift icon badge (TakenBadge)
   - [ ] Claimed items appear dimmed/faded
   - [ ] Claimed items are at bottom of list
   - [ ] NO claim buttons visible anywhere
   - [ ] NO claimer names or avatars visible
   - [ ] Header shows "X of Y items taken" counter

**Test 5: Celebrant Viewing Own Celebration (User A)**
1. As User A, navigate to your own celebration page:
   - [ ] NO claim buttons visible on your wishlist items
   - [ ] NO claimer information visible
   - (Celebrant should not see claim UI on their own celebration)

**Test 6: Race Condition (Optional)**
1. Have two users try to claim the same item simultaneously:
   - [ ] One succeeds, one gets "Already Claimed" message
   - [ ] Both see correct state after refresh
  </how-to-verify>
  <resume-signal>
Type "approved" if all tests pass.
If any test fails, describe the issue: "[Test X] - [what went wrong]"
  </resume-signal>
</task>

</tasks>

<verification>
User has verified all claim UI scenarios:
- Claim button visibility rules (standard only, not celebrant)
- Claim/unclaim flow with confirmations
- Claimer avatar and name popup
- Your claim indicator
- Taken badge and dimming for celebrant
- Counter display
- Sorting (claimed at bottom)
</verification>

<success_criteria>
- All 6 test scenarios pass
- Claim button only appears on standard items for non-celebrants
- Celebrant sees taken status but no claimer identity
- Race condition errors handled gracefully
- User approves the implementation
</success_criteria>

<output>
After completion, create `.planning/phases/19-gift-claims-ui/19-05-SUMMARY.md`
</output>
