---
phase: 19-gift-claims-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/wishlist/ClaimButton.tsx
  - components/wishlist/ClaimerAvatar.tsx
  - components/wishlist/TakenBadge.tsx
  - components/wishlist/YourClaimIndicator.tsx
autonomous: true

must_haves:
  truths:
    - "ClaimButton shows Claim text when item unclaimed"
    - "ClaimButton shows Unclaim text when user owns the claim"
    - "ClaimButton shows loading spinner during claim operation"
    - "TakenBadge displays gift icon in gold colors"
    - "ClaimerAvatar shows tappable avatar that reveals name popup"
  artifacts:
    - path: "components/wishlist/ClaimButton.tsx"
      provides: "Claim/Unclaim button with loading state"
      exports: ["ClaimButton"]
    - path: "components/wishlist/ClaimerAvatar.tsx"
      provides: "Small avatar with name popup on tap"
      exports: ["ClaimerAvatar"]
    - path: "components/wishlist/TakenBadge.tsx"
      provides: "Gift icon badge for celebrant view"
      exports: ["TakenBadge"]
    - path: "components/wishlist/YourClaimIndicator.tsx"
      provides: "Your claim highlight badge"
      exports: ["YourClaimIndicator"]
  key_links:
    - from: "components/wishlist/ClaimButton.tsx"
      to: "constants/theme"
      via: "import"
      pattern: "import.*from.*constants/theme"
---

<objective>
Create the core UI components for claim functionality: ClaimButton (claim/unclaim with loading), ClaimerAvatar (tappable avatar with name popup), TakenBadge (gift icon for celebrant view), and YourClaimIndicator (highlight for user's own claims).

Purpose: These building blocks are required before extending LuxuryWishlistCard with claim props.
Output: Four new components in components/wishlist/ ready for card integration.
</objective>

<execution_context>
@/home/zetaz/.claude/get-shit-done/workflows/execute-plan.md
@/home/zetaz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-gift-claims-ui/19-CONTEXT.md
@.planning/phases/19-gift-claims-ui/19-RESEARCH.md

# Relevant source files
@components/wishlist/LuxuryWishlistCard.tsx
@components/wishlist/ItemTypeBadge.tsx
@components/wishlist/MostWantedBadge.tsx
@constants/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ClaimButton and TakenBadge components</name>
  <files>
    components/wishlist/ClaimButton.tsx
    components/wishlist/TakenBadge.tsx
  </files>
  <action>
Create ClaimButton.tsx following the pattern from 19-RESEARCH.md Example 1:
- Props: onClaim, onUnclaim, isClaimed, isYourClaim, loading, disabled (for special items)
- If disabled, return null (don't render for surprise_me/mystery_box)
- If loading, show ActivityIndicator
- If isClaimed && isYourClaim, show "Unclaim" button with outline style (cream background, burgundy border)
- If isClaimed && !isYourClaim, button is disabled (claimed by someone else)
- If !isClaimed, show "Claim" button with success/gold background
- Use colors, spacing, borderRadius, shadows from theme.ts
- Button minimum width 80, minimum height 40

Create TakenBadge.tsx following 19-RESEARCH.md Example 2:
- Props: style (optional for positioning)
- Display MaterialCommunityIcons "gift" icon (size 18, gold[600] color)
- Background: gold[100], padding: spacing.xs, borderRadius: full
- Per CONTEXT: "Gift icon for taken indicator" (not text badge or checkmark)
  </action>
  <verify>
TypeScript compiles without errors: `npx tsc --noEmit 2>&1 | grep -E "(ClaimButton|TakenBadge)" || echo "No type errors"`
Files exist and export correct components: `grep -l "export.*ClaimButton\|export.*TakenBadge" components/wishlist/*.tsx`
  </verify>
  <done>
ClaimButton renders with three visual states (claim, unclaim, loading).
TakenBadge renders gift icon in gold colors.
Both files TypeScript clean.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ClaimerAvatar and YourClaimIndicator components</name>
  <files>
    components/wishlist/ClaimerAvatar.tsx
    components/wishlist/YourClaimIndicator.tsx
  </files>
  <action>
Create ClaimerAvatar.tsx following 19-RESEARCH.md Example 4:
- Props: claimer ({ id, display_name, avatar_url }), size (default 28)
- State: showName (boolean, controls popup visibility)
- Render TouchableOpacity with avatar image or initial-based placeholder
- Avatar border: 2px gold[300]
- On press: setShowName(true)
- Modal overlay (transparent, fade animation) showing "Claimed by {name}" text
- Pressable backdrop closes the popup
- Per CONTEXT: "Small claimer avatar shown on claimed item cards" and "Tapping shows tooltip/popup with claimer's name"

Create YourClaimIndicator.tsx:
- Simple badge component similar to MostWantedBadge pattern
- Text: "Your claim"
- Style: burgundy[100] background, burgundy[700] text, small padding
- Per CONTEXT: "Your own claims: Highlighted card treatment + Your claim indicator"
  </action>
  <verify>
TypeScript compiles: `npx tsc --noEmit 2>&1 | grep -E "(ClaimerAvatar|YourClaimIndicator)" || echo "No type errors"`
Files exist: `ls -la components/wishlist/ClaimerAvatar.tsx components/wishlist/YourClaimIndicator.tsx`
  </verify>
  <done>
ClaimerAvatar shows avatar with popup on tap revealing claimer name.
YourClaimIndicator shows "Your claim" badge.
Both files TypeScript clean.
  </done>
</task>

</tasks>

<verification>
All 4 component files exist in components/wishlist/:
```bash
ls components/wishlist/{ClaimButton,ClaimerAvatar,TakenBadge,YourClaimIndicator}.tsx
```

TypeScript compilation passes:
```bash
npx tsc --noEmit
```

Each component has proper exports:
```bash
grep "export" components/wishlist/ClaimButton.tsx components/wishlist/ClaimerAvatar.tsx components/wishlist/TakenBadge.tsx components/wishlist/YourClaimIndicator.tsx
```
</verification>

<success_criteria>
- ClaimButton.tsx exists with onClaim/onUnclaim/loading/disabled props
- ClaimerAvatar.tsx exists with claimer prop and popup on tap
- TakenBadge.tsx exists with gift icon rendering
- YourClaimIndicator.tsx exists with "Your claim" badge
- All components follow existing theme patterns (colors, spacing, borderRadius)
- No new TypeScript errors introduced
</success_criteria>

<output>
After completion, create `.planning/phases/19-gift-claims-ui/19-01-SUMMARY.md`
</output>
